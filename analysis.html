<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå - ‡πÅ‡∏≠‡∏õ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</title>
  
  <style>
    body {
      font-family: 'Nunito Sans', sans-serif;
      background-color: #FAFDFF;
      color: #333333;
      margin: 0;
      padding: 16px;
    }
    h1 {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 8px;
      color: #FB6A90;
      text-align: center;
    }
    .card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin-bottom: 20px;
    }
    .section-title {
      font-weight: 600;
      margin: 12px 0 8px;
      color: #286BA9;
    }
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå */
    .result-list {
      list-style: none;
      padding-left: 0;
    }
    .result-list li {
      padding: 8px 12px;
      background-color: #f7f9fc;
      border-radius: 8px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .result-list strong {
      color: #e91e63;
      font-size: 1.1rem;
    }
    .explanation {
      line-height: 1.6;
      font-size: 0.95rem;
      background-color: #fffde7; /* ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô */
      border: 1px solid #fbc02d;
      padding: 15px;
      border-radius: 12px;
    }
  </style>
</head>
<body>
  <h1>üìä ‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ</h1>

  <div class="card">
    <div class="section-title">‚ö° ‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</div>
    <ul id="symptom-results" class="result-list">
      </ul>
  </div>

  <div class="card">
    <div class="section-title">üòä ‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°</div>
    <ul id="mood-results" class="result-list">
      </ul>
  </div>

  <div class="card">
    <div class="section-title">üí° ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ú‡∏•</div>
    <div class="explanation">
      <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å LocalStorage ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ß‡πà‡∏≤...</p>
      <ul id="analysis-explanation">
        </ul>
      <p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÅ‡∏û‡∏ï‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô "‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏â‡∏±‡∏ô‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß‡∏ö‡πà‡∏≠‡∏¢" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏â‡∏±‡∏ô‡∏°‡∏±‡∏Å‡∏à‡∏∞‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏Ñ‡πà‡∏∞</p>
    </div>
  </div>

  <div class="card" style="text-align: center;">
    <a href="index.html" style="text-decoration: none; color: #555;">&larr; ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</a>
  </div>


  <script>
    document.addEventListener('DOMContentLoaded', () => {
      
      // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Object ‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏ö
      const symptomCounts = {};
      const moodCounts = {};
      let totalRecords = 0; // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡πà‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

      // 2. ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å LocalStorage
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);

        // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏ô‡πÉ‡∏à‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Key ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 'YYYY-MM-DD'
        // (‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à Key 'cycleHistory' ‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏õ‡πÅ‡∏£‡∏Å)
        if (/^\d{4}-\d{2}-\d{2}$/.test(key)) {
          totalRecords++;
          const data = JSON.parse(localStorage.getItem(key));

          // 3. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
          
          // ‡∏ô‡∏±‡∏ö‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå
          if (data.mood) {
            moodCounts[data.mood] = (moodCounts[data.mood] || 0) + 1;
          }

          // ‡∏ô‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ (‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô Array)
          if (data.symptoms && data.symptoms.length > 0) {
            data.symptoms.forEach(symptom => {
              symptomCounts[symptom] = (symptomCounts[symptom] || 0) + 1;
            });
          }
        }
      }

      // 4. ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
      const sortedSymptoms = Object.entries(symptomCounts).sort((a, b) => b[1] - a[1]);
      const sortedMoods = Object.entries(moodCounts).sort((a, b) => b[1] - a[1]);

      // 5. ‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
      const symptomList = document.getElementById('symptom-results');
      const moodList = document.getElementById('mood-results');
      const explanationList = document.getElementById('analysis-explanation');

      // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏£
      if (sortedSymptoms.length === 0) {
        symptomList.innerHTML = '<li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏Å‡∏≤‡∏£</li>';
      } else {
        sortedSymptoms.forEach(([name, count]) => {
          symptomList.innerHTML += `<li>${name} <span><strong>${count} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong></span></li>`;
        });
      }

      // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå
      if (sortedMoods.length === 0) {
        moodList.innerHTML = '<li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå</li>';
      } else {
        sortedMoods.forEach(([name, count]) => {
          moodList.innerHTML += `<li>${name} <span><strong>${count} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</strong></span></li>`;
        });
      }

      // 6. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å
      const topSymptom = sortedSymptoms[0] ? sortedSymptoms[0][0] : '‡πÑ‡∏°‡πà‡∏°‡∏µ';
      const topMood = sortedMoods[0] ? sortedMoods[0][0] : '‡πÑ‡∏°‡πà‡∏°‡∏µ';

      explanationList.innerHTML = `
        <li>‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <strong>${totalRecords} ‡∏ß‡∏±‡∏ô</strong></li>
        <li>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ <strong>${topSymptom}</strong></li>
        <li>‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ <strong>${topMood}</strong></li>
      `;

    });
  </script>

</body>
</html>